# Fragestellung 1.2: Wie viele EinwohnerInnen und Beschäftigte sind duch hohe Öl- und Gaspreise in einer Gemeinde betroffen?

Um diese Fragen zu beantworten, werden Daten aus dem "Gebäude- und Wohnungsregister (GWR)", der "Statistik der Bevölkerung (STATPOP)", der "Statistik der Unternehmensstruktur (STATENT)" und die offiziellen Gemeindegrenzen (swissBOUNDARIES3D). verwendet.


```python
# Zu verwendende Bibliotheken importieren
import pandas as pd
import geopandas as gpd
import geoplot as gplt
import shapely.geometry
from io import BytesIO
from zipfile import ZipFile
from urllib.request import urlopen
import requests
import json
```

    ERROR 1: PROJ: proj_create_from_database: Open of /opt/conda/share/proj failed
    


```python
# STATPOP einlesen und erste Zeilen anschauen
# Die Statpop Daten enthalten die Anzahl EinwohnerInnen pro Hektarzelle.
    
# Datenquelle definieren
url = urlopen("https://dam-api.bfs.admin.ch/hub/api/dam/assets/23528269/master")

# ZIP-File herunterladen und Dataframe erstellen
zipfile = ZipFile(BytesIO(url.read()))
statpop = pd.read_csv(zipfile.open('ag-b-00.03-vz2021statpop/STATPOP2021.csv'), 
                     sep=';',
                     usecols = ['RELI', 'E_KOORD','N_KOORD','B21BTOT'])

statpop.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RELI</th>
      <th>E_KOORD</th>
      <th>N_KOORD</th>
      <th>B21BTOT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48621113</td>
      <td>2486200</td>
      <td>1111300</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48621114</td>
      <td>2486200</td>
      <td>1111400</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48621115</td>
      <td>2486200</td>
      <td>1111500</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48631114</td>
      <td>2486300</td>
      <td>1111400</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>48631115</td>
      <td>2486300</td>
      <td>1111500</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>




```python
statpop
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RELI</th>
      <th>E_KOORD</th>
      <th>N_KOORD</th>
      <th>B21BTOT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48621113</td>
      <td>2486200</td>
      <td>1111300</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48621114</td>
      <td>2486200</td>
      <td>1111400</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48621115</td>
      <td>2486200</td>
      <td>1111500</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48631114</td>
      <td>2486300</td>
      <td>1111400</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>48631115</td>
      <td>2486300</td>
      <td>1111500</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>346832</th>
      <td>83101690</td>
      <td>2831000</td>
      <td>1169000</td>
      <td>5</td>
    </tr>
    <tr>
      <th>346833</th>
      <td>83101692</td>
      <td>2831000</td>
      <td>1169200</td>
      <td>3</td>
    </tr>
    <tr>
      <th>346834</th>
      <td>83111692</td>
      <td>2831100</td>
      <td>1169200</td>
      <td>3</td>
    </tr>
    <tr>
      <th>346835</th>
      <td>83111693</td>
      <td>2831100</td>
      <td>1169300</td>
      <td>13</td>
    </tr>
    <tr>
      <th>346836</th>
      <td>83202015</td>
      <td>2832000</td>
      <td>1201500</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>346837 rows × 4 columns</p>
</div>




```python
# Die Statpop Daten enthalten die Anzahl EinwohnerInnen pro Hektarzelle.
# Damit aus den Punkten aus der Statistik ein Polygon wird, werden die vier Stützpunkte erstellt.
# Dazu werdenKopien der Dataframes erstellt und die Koordinaten der vier Ecken berechnet (+100m).
statpop2 = statpop.copy()
statpop2['E_KOORD'] = statpop2['E_KOORD']+100

statpop3 = statpop.copy()
statpop3['E_KOORD'] = statpop3['E_KOORD']+100
statpop3['N_KOORD'] = statpop3['N_KOORD']+100

statpop4 = statpop.copy()
statpop4['N_KOORD'] = statpop4['N_KOORD']+100

statpop5 = statpop.copy()
```


```python
#Die vier Dataframes zusammenführen.
statpoptot = pd.concat([statpop, statpop2, statpop3, statpop4, statpop5])
statpoptot
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RELI</th>
      <th>E_KOORD</th>
      <th>N_KOORD</th>
      <th>B21BTOT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48621113</td>
      <td>2486200</td>
      <td>1111300</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48621114</td>
      <td>2486200</td>
      <td>1111400</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48621115</td>
      <td>2486200</td>
      <td>1111500</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48631114</td>
      <td>2486300</td>
      <td>1111400</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>48631115</td>
      <td>2486300</td>
      <td>1111500</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>346832</th>
      <td>83101690</td>
      <td>2831000</td>
      <td>1169000</td>
      <td>5</td>
    </tr>
    <tr>
      <th>346833</th>
      <td>83101692</td>
      <td>2831000</td>
      <td>1169200</td>
      <td>3</td>
    </tr>
    <tr>
      <th>346834</th>
      <td>83111692</td>
      <td>2831100</td>
      <td>1169200</td>
      <td>3</td>
    </tr>
    <tr>
      <th>346835</th>
      <td>83111693</td>
      <td>2831100</td>
      <td>1169300</td>
      <td>13</td>
    </tr>
    <tr>
      <th>346836</th>
      <td>83202015</td>
      <td>2832000</td>
      <td>1201500</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>1734185 rows × 4 columns</p>
</div>




```python
#Ein Geodataframe erstellen mit Polygonen welches aus den vier Punkten einer Rasterzelle bestehen.
gdf= gpd.GeoDataFrame(
    statpoptot.groupby("RELI").apply(
        lambda d: pd.Series(
            {
                "geometry": shapely.geometry.Polygon(
                    d.loc[:, ["E_KOORD", "N_KOORD"]].values
                ),
            }
        )
    )
,crs="EPSG:2056")
gdf.plot(markersize=.1, figsize=(8, 8))
```




    <AxesSubplot: >




    
![png](https://raw.githubusercontent.com/nrohrbach/HeizcheckGemeinde/pages/Bilder/output_6_1.png)
    



```python
#Mit initialem Dataframe zusammenführen um die Anzahl Einwohner zu erhalten.
StatpopRaster = pd.merge(gdf, statpop, on='RELI')
StatpopRaster
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RELI</th>
      <th>geometry</th>
      <th>E_KOORD</th>
      <th>N_KOORD</th>
      <th>B21BTOT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48621113</td>
      <td>POLYGON ((2486200.000 1111300.000, 2486300.000...</td>
      <td>2486200</td>
      <td>1111300</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48621114</td>
      <td>POLYGON ((2486200.000 1111400.000, 2486300.000...</td>
      <td>2486200</td>
      <td>1111400</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48621115</td>
      <td>POLYGON ((2486200.000 1111500.000, 2486300.000...</td>
      <td>2486200</td>
      <td>1111500</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48631114</td>
      <td>POLYGON ((2486300.000 1111400.000, 2486400.000...</td>
      <td>2486300</td>
      <td>1111400</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>48631115</td>
      <td>POLYGON ((2486300.000 1111500.000, 2486400.000...</td>
      <td>2486300</td>
      <td>1111500</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>346832</th>
      <td>83101690</td>
      <td>POLYGON ((2831000.000 1169000.000, 2831100.000...</td>
      <td>2831000</td>
      <td>1169000</td>
      <td>5</td>
    </tr>
    <tr>
      <th>346833</th>
      <td>83101692</td>
      <td>POLYGON ((2831000.000 1169200.000, 2831100.000...</td>
      <td>2831000</td>
      <td>1169200</td>
      <td>3</td>
    </tr>
    <tr>
      <th>346834</th>
      <td>83111692</td>
      <td>POLYGON ((2831100.000 1169200.000, 2831200.000...</td>
      <td>2831100</td>
      <td>1169200</td>
      <td>3</td>
    </tr>
    <tr>
      <th>346835</th>
      <td>83111693</td>
      <td>POLYGON ((2831100.000 1169300.000, 2831200.000...</td>
      <td>2831100</td>
      <td>1169300</td>
      <td>13</td>
    </tr>
    <tr>
      <th>346836</th>
      <td>83202015</td>
      <td>POLYGON ((2832000.000 1201500.000, 2832100.000...</td>
      <td>2832000</td>
      <td>1201500</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>346837 rows × 5 columns</p>
</div>




```python
#in WGS84 transformieren
StatpopRaster = StatpopRaster.to_crs(epsg='4326')
StatpopRaster
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RELI</th>
      <th>geometry</th>
      <th>E_KOORD</th>
      <th>N_KOORD</th>
      <th>B21BTOT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48621113</td>
      <td>POLYGON ((5.96582 46.14355, 5.96711 46.14357, ...</td>
      <td>2486200</td>
      <td>1111300</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48621114</td>
      <td>POLYGON ((5.96580 46.14445, 5.96709 46.14447, ...</td>
      <td>2486200</td>
      <td>1111400</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48621115</td>
      <td>POLYGON ((5.96577 46.14535, 5.96707 46.14537, ...</td>
      <td>2486200</td>
      <td>1111500</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48631114</td>
      <td>POLYGON ((5.96709 46.14447, 5.96838 46.14449, ...</td>
      <td>2486300</td>
      <td>1111400</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>48631115</td>
      <td>POLYGON ((5.96707 46.14537, 5.96836 46.14539, ...</td>
      <td>2486300</td>
      <td>1111500</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>346832</th>
      <td>83101690</td>
      <td>POLYGON ((10.45592 46.63227, 10.45722 46.63223...</td>
      <td>2831000</td>
      <td>1169000</td>
      <td>5</td>
    </tr>
    <tr>
      <th>346833</th>
      <td>83101692</td>
      <td>POLYGON ((10.45602 46.63406, 10.45732 46.63403...</td>
      <td>2831000</td>
      <td>1169200</td>
      <td>3</td>
    </tr>
    <tr>
      <th>346834</th>
      <td>83111692</td>
      <td>POLYGON ((10.45732 46.63403, 10.45863 46.63399...</td>
      <td>2831100</td>
      <td>1169200</td>
      <td>3</td>
    </tr>
    <tr>
      <th>346835</th>
      <td>83111693</td>
      <td>POLYGON ((10.45737 46.63493, 10.45868 46.63489...</td>
      <td>2831100</td>
      <td>1169300</td>
      <td>13</td>
    </tr>
    <tr>
      <th>346836</th>
      <td>83202015</td>
      <td>POLYGON ((10.48545 46.92405, 10.48676 46.92402...</td>
      <td>2832000</td>
      <td>1201500</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
<p>346837 rows × 5 columns</p>
</div>



# 2. GWR Gebäudedaten aufbereiten


```python
# GWR-Daten Gebäude einlesen und erste Zeilen anschauen
gwr = urlopen("https://public.madd.bfs.admin.ch/ch.zip")

# ZIP-File herunterladen und Dataframe erstellen
zipfile = ZipFile(BytesIO(gwr.read()))
Gebaeude = pd.read_csv(zipfile.open('gebaeude_batiment_edificio.csv'), 
                     sep='\t',
                     usecols = ['GGDENR','GGDENAME','GKODE','GKODN','GKAT','GENH1','GEBF','GAREA','GBAUJ'])

Gebaeude.head()


# GWR-Daten Gebäude einlesen und erste Zeilen anschauen

#Gebaeude = pd.read_csv(r'C:\Users\AninaNico\Documents\CAS_SpatialDataAnalytics\Zertifikatsarbeit\Uebung\Daten\GWR/gebaeude_batiment_edificio.csv',
#                sep='\t',
#                usecols = ['GGDENR','GGDENAME','GKODE','GKODN','GKAT','GENH1','GEBF','GAREA','GBAUJ'])
#Gebaeude.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GGDENR</th>
      <th>GGDENAME</th>
      <th>GKODE</th>
      <th>GKODN</th>
      <th>GKAT</th>
      <th>GBAUJ</th>
      <th>GAREA</th>
      <th>GEBF</th>
      <th>GENH1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679647.268</td>
      <td>1237500.347</td>
      <td>1020.0</td>
      <td>2000.0</td>
      <td>166.0</td>
      <td>NaN</td>
      <td>7530.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2680635.900</td>
      <td>1236936.229</td>
      <td>1020.0</td>
      <td>2000.0</td>
      <td>90.0</td>
      <td>NaN</td>
      <td>7530.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679016.828</td>
      <td>1235828.156</td>
      <td>1020.0</td>
      <td>1993.0</td>
      <td>72.0</td>
      <td>NaN</td>
      <td>7530.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679677.869</td>
      <td>1237453.256</td>
      <td>1020.0</td>
      <td>1845.0</td>
      <td>165.0</td>
      <td>NaN</td>
      <td>7530.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679692.997</td>
      <td>1237491.284</td>
      <td>1030.0</td>
      <td>1900.0</td>
      <td>313.0</td>
      <td>NaN</td>
      <td>7530.0</td>
    </tr>
  </tbody>
</table>
</div>



# Energiequellen mit NaN als "Unbestimmt" weiter verwenden.


```python
# Die korrekten Bezeichnungen den Heizcodes zuweisen und als Liste speichern.
Gebaeude['Energiequelle'] = Gebaeude.GENH1.replace({
                                            7500: 'Keine',
                                            7501: 'Weitere',
                                            7510: 'Weitere',
                                            7511: 'Weitere',
                                            7512: 'Weitere',
                                            7513: 'Weitere',
                                            7520: 'Gas',
                                            7530: 'Heizöl',
                                            7540: 'Weitere',
                                            7541: 'Weitere',
                                            7542: 'Weitere',
                                            7543: 'Weitere',
                                            7550: 'Weitere',
                                            7560: 'Elektrizität',
                                            7570: 'Weitere',
                                            7580: 'Weitere',
                                            7581: 'Weitere',
                                            7582: 'Weitere',
                                            7598: 'Unbestimmt',
                                            7599: 'Keine'
                                            })
```


```python
# NULL Werte bei der Energiequelle werden zu "Unbestimmt" gemappt
Gebaeude['Energiequelle'] = Gebaeude['Energiequelle'].fillna('Unbestimmt')
Gebaeude
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GGDENR</th>
      <th>GGDENAME</th>
      <th>GKODE</th>
      <th>GKODN</th>
      <th>GKAT</th>
      <th>GBAUJ</th>
      <th>GAREA</th>
      <th>GEBF</th>
      <th>GENH1</th>
      <th>Energiequelle</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679647.268</td>
      <td>1237500.347</td>
      <td>1020.0</td>
      <td>2000.0</td>
      <td>166.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2680635.900</td>
      <td>1236936.229</td>
      <td>1020.0</td>
      <td>2000.0</td>
      <td>90.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679016.828</td>
      <td>1235828.156</td>
      <td>1020.0</td>
      <td>1993.0</td>
      <td>72.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679677.869</td>
      <td>1237453.256</td>
      <td>1020.0</td>
      <td>1845.0</td>
      <td>165.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679692.997</td>
      <td>1237491.284</td>
      <td>1030.0</td>
      <td>1900.0</td>
      <td>313.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3069089</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2582768.637</td>
      <td>1251359.261</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>85.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>3069090</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2582743.072</td>
      <td>1251406.135</td>
      <td>1040.0</td>
      <td>NaN</td>
      <td>172.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>3069091</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2584600.501</td>
      <td>1251495.804</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>71.0</td>
      <td>NaN</td>
      <td>7520.0</td>
      <td>Gas</td>
    </tr>
    <tr>
      <th>3069092</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2583393.948</td>
      <td>1251448.443</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>83.0</td>
      <td>NaN</td>
      <td>7540.0</td>
      <td>Weitere</td>
    </tr>
    <tr>
      <th>3069093</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2582634.389</td>
      <td>1251094.914</td>
      <td>1020.0</td>
      <td>1978.0</td>
      <td>266.0</td>
      <td>266.0</td>
      <td>7540.0</td>
      <td>Weitere</td>
    </tr>
  </tbody>
</table>
<p>3069094 rows × 10 columns</p>
</div>




```python
#Gebäude ohne Wohnnutzung (GKAT=1060) werden rausgefiltert
Wohngebaeude = Gebaeude.query('GKAT in[1010, 1020, 1030, 1040, 1080]')
Wohngebaeude
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GGDENR</th>
      <th>GGDENAME</th>
      <th>GKODE</th>
      <th>GKODN</th>
      <th>GKAT</th>
      <th>GBAUJ</th>
      <th>GAREA</th>
      <th>GEBF</th>
      <th>GENH1</th>
      <th>Energiequelle</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679647.268</td>
      <td>1237500.347</td>
      <td>1020.0</td>
      <td>2000.0</td>
      <td>166.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2680635.900</td>
      <td>1236936.229</td>
      <td>1020.0</td>
      <td>2000.0</td>
      <td>90.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679016.828</td>
      <td>1235828.156</td>
      <td>1020.0</td>
      <td>1993.0</td>
      <td>72.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679677.869</td>
      <td>1237453.256</td>
      <td>1020.0</td>
      <td>1845.0</td>
      <td>165.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679692.997</td>
      <td>1237491.284</td>
      <td>1030.0</td>
      <td>1900.0</td>
      <td>313.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3069089</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2582768.637</td>
      <td>1251359.261</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>85.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>3069090</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2582743.072</td>
      <td>1251406.135</td>
      <td>1040.0</td>
      <td>NaN</td>
      <td>172.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>3069091</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2584600.501</td>
      <td>1251495.804</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>71.0</td>
      <td>NaN</td>
      <td>7520.0</td>
      <td>Gas</td>
    </tr>
    <tr>
      <th>3069092</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2583393.948</td>
      <td>1251448.443</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>83.0</td>
      <td>NaN</td>
      <td>7540.0</td>
      <td>Weitere</td>
    </tr>
    <tr>
      <th>3069093</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2582634.389</td>
      <td>1251094.914</td>
      <td>1020.0</td>
      <td>1978.0</td>
      <td>266.0</td>
      <td>266.0</td>
      <td>7540.0</td>
      <td>Weitere</td>
    </tr>
  </tbody>
</table>
<p>1980747 rows × 10 columns</p>
</div>




```python
Wohngebaeude.isnull().sum()
```




    GGDENR                 0
    GGDENAME               0
    GKODE                515
    GKODN                515
    GKAT                   0
    GBAUJ             927036
    GAREA              69093
    GEBF             1824175
    GENH1             100960
    Energiequelle          0
    dtype: int64




```python
# Gebäude nur bis Baujahr 2021 und unbekannt werden berücksichtigt, weil die aktuellsten Statpopdaten den Datenstand 31.12.2021 haben.
Wohngebaeude = Wohngebaeude.loc[Wohngebaeude['GBAUJ']!=2022]
Wohngebaeude

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GGDENR</th>
      <th>GGDENAME</th>
      <th>GKODE</th>
      <th>GKODN</th>
      <th>GKAT</th>
      <th>GBAUJ</th>
      <th>GAREA</th>
      <th>GEBF</th>
      <th>GENH1</th>
      <th>Energiequelle</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679647.268</td>
      <td>1237500.347</td>
      <td>1020.0</td>
      <td>2000.0</td>
      <td>166.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2680635.900</td>
      <td>1236936.229</td>
      <td>1020.0</td>
      <td>2000.0</td>
      <td>90.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679016.828</td>
      <td>1235828.156</td>
      <td>1020.0</td>
      <td>1993.0</td>
      <td>72.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679677.869</td>
      <td>1237453.256</td>
      <td>1020.0</td>
      <td>1845.0</td>
      <td>165.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679692.997</td>
      <td>1237491.284</td>
      <td>1030.0</td>
      <td>1900.0</td>
      <td>313.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3069089</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2582768.637</td>
      <td>1251359.261</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>85.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>3069090</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2582743.072</td>
      <td>1251406.135</td>
      <td>1040.0</td>
      <td>NaN</td>
      <td>172.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>3069091</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2584600.501</td>
      <td>1251495.804</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>71.0</td>
      <td>NaN</td>
      <td>7520.0</td>
      <td>Gas</td>
    </tr>
    <tr>
      <th>3069092</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2583393.948</td>
      <td>1251448.443</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>83.0</td>
      <td>NaN</td>
      <td>7540.0</td>
      <td>Weitere</td>
    </tr>
    <tr>
      <th>3069093</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2582634.389</td>
      <td>1251094.914</td>
      <td>1020.0</td>
      <td>1978.0</td>
      <td>266.0</td>
      <td>266.0</td>
      <td>7540.0</td>
      <td>Weitere</td>
    </tr>
  </tbody>
</table>
<p>1972564 rows × 10 columns</p>
</div>




```python
#Geodataframe mit den Wohngebäuden aus dem GWR erstellen.
Wohngebaeude_gdf = gpd.GeoDataFrame(
    Wohngebaeude, geometry=gpd.points_from_xy(Wohngebaeude.GKODE, Wohngebaeude.GKODN,crs="EPSG:2056"))

Wohngebaeude_gdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GGDENR</th>
      <th>GGDENAME</th>
      <th>GKODE</th>
      <th>GKODN</th>
      <th>GKAT</th>
      <th>GBAUJ</th>
      <th>GAREA</th>
      <th>GEBF</th>
      <th>GENH1</th>
      <th>Energiequelle</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679647.268</td>
      <td>1237500.347</td>
      <td>1020.0</td>
      <td>2000.0</td>
      <td>166.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
      <td>POINT (2679647.268 1237500.347)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2680635.900</td>
      <td>1236936.229</td>
      <td>1020.0</td>
      <td>2000.0</td>
      <td>90.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
      <td>POINT (2680635.900 1236936.229)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679016.828</td>
      <td>1235828.156</td>
      <td>1020.0</td>
      <td>1993.0</td>
      <td>72.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
      <td>POINT (2679016.828 1235828.156)</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679677.869</td>
      <td>1237453.256</td>
      <td>1020.0</td>
      <td>1845.0</td>
      <td>165.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
      <td>POINT (2679677.869 1237453.256)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Aeugst am Albis</td>
      <td>2679692.997</td>
      <td>1237491.284</td>
      <td>1030.0</td>
      <td>1900.0</td>
      <td>313.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
      <td>POINT (2679692.997 1237491.284)</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3069089</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2582768.637</td>
      <td>1251359.261</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>85.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
      <td>POINT (2582768.637 1251359.261)</td>
    </tr>
    <tr>
      <th>3069090</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2582743.072</td>
      <td>1251406.135</td>
      <td>1040.0</td>
      <td>NaN</td>
      <td>172.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
      <td>POINT (2582743.072 1251406.135)</td>
    </tr>
    <tr>
      <th>3069091</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2584600.501</td>
      <td>1251495.804</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>71.0</td>
      <td>NaN</td>
      <td>7520.0</td>
      <td>Gas</td>
      <td>POINT (2584600.501 1251495.804)</td>
    </tr>
    <tr>
      <th>3069092</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2583393.948</td>
      <td>1251448.443</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>83.0</td>
      <td>NaN</td>
      <td>7540.0</td>
      <td>Weitere</td>
      <td>POINT (2583393.948 1251448.443)</td>
    </tr>
    <tr>
      <th>3069093</th>
      <td>6810</td>
      <td>La Baroche</td>
      <td>2582634.389</td>
      <td>1251094.914</td>
      <td>1020.0</td>
      <td>1978.0</td>
      <td>266.0</td>
      <td>266.0</td>
      <td>7540.0</td>
      <td>Weitere</td>
      <td>POINT (2582634.389 1251094.914)</td>
    </tr>
  </tbody>
</table>
<p>1972564 rows × 11 columns</p>
</div>




```python
#Geodataframe mit Wohngebäuden in wGS84 transformieren.
Wohngebaeude_gdf = Wohngebaeude_gdf.to_crs(epsg='4326')
```


```python
Wohngebaeude_gdf.plot(markersize=.1, figsize=(8, 8))
```




    <AxesSubplot: >




    
![png](https://raw.githubusercontent.com/nrohrbach/HeizcheckGemeinde/pages/Bilder/output_19_1.png)
    



```python
#Spatial Join der Wohnbevölkerung im Hektarraster (StatpopRaster) und der Wohngebäude aus dem GWR (Wohngebaeude_gdf)
dfsjoin = gpd.sjoin(StatpopRaster, Wohngebaeude_gdf) 
```


```python
dfsjoin
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RELI</th>
      <th>geometry</th>
      <th>E_KOORD</th>
      <th>N_KOORD</th>
      <th>B21BTOT</th>
      <th>index_right</th>
      <th>GGDENR</th>
      <th>GGDENAME</th>
      <th>GKODE</th>
      <th>GKODN</th>
      <th>GKAT</th>
      <th>GBAUJ</th>
      <th>GAREA</th>
      <th>GEBF</th>
      <th>GENH1</th>
      <th>Energiequelle</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48621113</td>
      <td>POLYGON ((5.96582 46.14355, 5.96711 46.14357, ...</td>
      <td>2486200</td>
      <td>1111300</td>
      <td>3</td>
      <td>2972629</td>
      <td>6611</td>
      <td>Chancy</td>
      <td>2486216.250</td>
      <td>1111388.380</td>
      <td>1030.0</td>
      <td>1907.0</td>
      <td>137.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48621114</td>
      <td>POLYGON ((5.96580 46.14445, 5.96709 46.14447, ...</td>
      <td>2486200</td>
      <td>1111400</td>
      <td>5</td>
      <td>2972628</td>
      <td>6611</td>
      <td>Chancy</td>
      <td>2486220.750</td>
      <td>1111411.190</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>190.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48621115</td>
      <td>POLYGON ((5.96577 46.14535, 5.96707 46.14537, ...</td>
      <td>2486200</td>
      <td>1111500</td>
      <td>3</td>
      <td>2972627</td>
      <td>6611</td>
      <td>Chancy</td>
      <td>2486262.500</td>
      <td>1111523.750</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>66.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48621115</td>
      <td>POLYGON ((5.96577 46.14535, 5.96707 46.14537, ...</td>
      <td>2486200</td>
      <td>1111500</td>
      <td>3</td>
      <td>2972626</td>
      <td>6611</td>
      <td>Chancy</td>
      <td>2486266.500</td>
      <td>1111530.440</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>89.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48621115</td>
      <td>POLYGON ((5.96577 46.14535, 5.96707 46.14537, ...</td>
      <td>2486200</td>
      <td>1111500</td>
      <td>3</td>
      <td>2972632</td>
      <td>6611</td>
      <td>Chancy</td>
      <td>2486295.750</td>
      <td>1111580.130</td>
      <td>1020.0</td>
      <td>NaN</td>
      <td>82.0</td>
      <td>NaN</td>
      <td>7540.0</td>
      <td>Weitere</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>346835</th>
      <td>83111693</td>
      <td>POLYGON ((10.45737 46.63493, 10.45868 46.63489...</td>
      <td>2831100</td>
      <td>1169300</td>
      <td>13</td>
      <td>1893150</td>
      <td>3847</td>
      <td>Val Müstair</td>
      <td>2831159.612</td>
      <td>1169317.534</td>
      <td>1030.0</td>
      <td>1940.0</td>
      <td>70.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>346835</th>
      <td>83111693</td>
      <td>POLYGON ((10.45737 46.63493, 10.45868 46.63489...</td>
      <td>2831100</td>
      <td>1169300</td>
      <td>13</td>
      <td>1892650</td>
      <td>3847</td>
      <td>Val Müstair</td>
      <td>2831127.398</td>
      <td>1169327.474</td>
      <td>1020.0</td>
      <td>1960.0</td>
      <td>173.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>346835</th>
      <td>83111693</td>
      <td>POLYGON ((10.45737 46.63493, 10.45868 46.63489...</td>
      <td>2831100</td>
      <td>1169300</td>
      <td>13</td>
      <td>1892648</td>
      <td>3847</td>
      <td>Val Müstair</td>
      <td>2831158.578</td>
      <td>1169342.603</td>
      <td>1040.0</td>
      <td>NaN</td>
      <td>224.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>346835</th>
      <td>83111693</td>
      <td>POLYGON ((10.45737 46.63493, 10.45868 46.63489...</td>
      <td>2831100</td>
      <td>1169300</td>
      <td>13</td>
      <td>1892649</td>
      <td>3847</td>
      <td>Val Müstair</td>
      <td>2831144.784</td>
      <td>1169350.606</td>
      <td>1020.0</td>
      <td>1960.0</td>
      <td>172.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
    <tr>
      <th>346836</th>
      <td>83202015</td>
      <td>POLYGON ((10.48545 46.92405, 10.48676 46.92402...</td>
      <td>2832000</td>
      <td>1201500</td>
      <td>3</td>
      <td>1877249</td>
      <td>3764</td>
      <td>Valsot</td>
      <td>2832034.469</td>
      <td>1201587.898</td>
      <td>1020.0</td>
      <td>1942.0</td>
      <td>123.0</td>
      <td>NaN</td>
      <td>7530.0</td>
      <td>Heizöl</td>
    </tr>
  </tbody>
</table>
<p>1866945 rows × 16 columns</p>
</div>




```python
# Pivottabelle erstellen
# Damit erhalte ich für jede Hektarrasterzelle aus dem Statpop (id=RELI) die Anzahl Gebäude nach Energiequelle.
dfpivot = pd.pivot_table(dfsjoin,index='RELI',columns='Energiequelle',aggfunc={'Energiequelle':len})
dfpivot.columns = dfpivot.columns.droplevel()
dfpivot
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Energiequelle</th>
      <th>Elektrizität</th>
      <th>Gas</th>
      <th>Heizöl</th>
      <th>Keine</th>
      <th>Unbestimmt</th>
      <th>Weitere</th>
    </tr>
    <tr>
      <th>RELI</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48621113</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>48621114</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>48621115</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>48631114</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>48631115</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>83101690</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>83101692</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>83111692</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>83111693</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>83202015</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>345417 rows × 6 columns</p>
</div>




```python
# Nun wird die Pivottabelle mit dem Geodatenframe (StatpopRaster) gemergt. 
EnergiequellenRaster = StatpopRaster.merge(dfpivot, how='left', on='RELI')
EnergiequellenRaster
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RELI</th>
      <th>geometry</th>
      <th>E_KOORD</th>
      <th>N_KOORD</th>
      <th>B21BTOT</th>
      <th>Elektrizität</th>
      <th>Gas</th>
      <th>Heizöl</th>
      <th>Keine</th>
      <th>Unbestimmt</th>
      <th>Weitere</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48621113</td>
      <td>POLYGON ((5.96582 46.14355, 5.96711 46.14357, ...</td>
      <td>2486200</td>
      <td>1111300</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48621114</td>
      <td>POLYGON ((5.96580 46.14445, 5.96709 46.14447, ...</td>
      <td>2486200</td>
      <td>1111400</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48621115</td>
      <td>POLYGON ((5.96577 46.14535, 5.96707 46.14537, ...</td>
      <td>2486200</td>
      <td>1111500</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48631114</td>
      <td>POLYGON ((5.96709 46.14447, 5.96838 46.14449, ...</td>
      <td>2486300</td>
      <td>1111400</td>
      <td>4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>48631115</td>
      <td>POLYGON ((5.96707 46.14537, 5.96836 46.14539, ...</td>
      <td>2486300</td>
      <td>1111500</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>346832</th>
      <td>83101690</td>
      <td>POLYGON ((10.45592 46.63227, 10.45722 46.63223...</td>
      <td>2831000</td>
      <td>1169000</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>346833</th>
      <td>83101692</td>
      <td>POLYGON ((10.45602 46.63406, 10.45732 46.63403...</td>
      <td>2831000</td>
      <td>1169200</td>
      <td>3</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>346834</th>
      <td>83111692</td>
      <td>POLYGON ((10.45732 46.63403, 10.45863 46.63399...</td>
      <td>2831100</td>
      <td>1169200</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>346835</th>
      <td>83111693</td>
      <td>POLYGON ((10.45737 46.63493, 10.45868 46.63489...</td>
      <td>2831100</td>
      <td>1169300</td>
      <td>13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>346836</th>
      <td>83202015</td>
      <td>POLYGON ((10.48545 46.92405, 10.48676 46.92402...</td>
      <td>2832000</td>
      <td>1201500</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>346837 rows × 11 columns</p>
</div>




```python
# Prüfen ob noch NULL Werte vorhanden sind.
EnergiequellenRaster.isnull().sum()
```




    RELI                 0
    geometry             0
    E_KOORD              0
    N_KOORD              0
    B21BTOT              0
    Elektrizität    276935
    Gas             262771
    Heizöl          115155
    Keine           330239
    Unbestimmt      199711
    Weitere         178381
    dtype: int64




```python
# Die NULL Werte werden mit 0 ersetzt.
EnergiequellenRaster = EnergiequellenRaster.fillna(0)
EnergiequellenRaster

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RELI</th>
      <th>geometry</th>
      <th>E_KOORD</th>
      <th>N_KOORD</th>
      <th>B21BTOT</th>
      <th>Elektrizität</th>
      <th>Gas</th>
      <th>Heizöl</th>
      <th>Keine</th>
      <th>Unbestimmt</th>
      <th>Weitere</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48621113</td>
      <td>POLYGON ((5.96582 46.14355, 5.96711 46.14357, ...</td>
      <td>2486200</td>
      <td>1111300</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48621114</td>
      <td>POLYGON ((5.96580 46.14445, 5.96709 46.14447, ...</td>
      <td>2486200</td>
      <td>1111400</td>
      <td>5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48621115</td>
      <td>POLYGON ((5.96577 46.14535, 5.96707 46.14537, ...</td>
      <td>2486200</td>
      <td>1111500</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48631114</td>
      <td>POLYGON ((5.96709 46.14447, 5.96838 46.14449, ...</td>
      <td>2486300</td>
      <td>1111400</td>
      <td>4</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>48631115</td>
      <td>POLYGON ((5.96707 46.14537, 5.96836 46.14539, ...</td>
      <td>2486300</td>
      <td>1111500</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>346832</th>
      <td>83101690</td>
      <td>POLYGON ((10.45592 46.63227, 10.45722 46.63223...</td>
      <td>2831000</td>
      <td>1169000</td>
      <td>5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>346833</th>
      <td>83101692</td>
      <td>POLYGON ((10.45602 46.63406, 10.45732 46.63403...</td>
      <td>2831000</td>
      <td>1169200</td>
      <td>3</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>346834</th>
      <td>83111692</td>
      <td>POLYGON ((10.45732 46.63403, 10.45863 46.63399...</td>
      <td>2831100</td>
      <td>1169200</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>346835</th>
      <td>83111693</td>
      <td>POLYGON ((10.45737 46.63493, 10.45868 46.63489...</td>
      <td>2831100</td>
      <td>1169300</td>
      <td>13</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>346836</th>
      <td>83202015</td>
      <td>POLYGON ((10.48545 46.92405, 10.48676 46.92402...</td>
      <td>2832000</td>
      <td>1201500</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>346837 rows × 11 columns</p>
</div>




```python
#Die Anzahl Gebäude pro Hektarraster zählen
EnergiequellenRaster['AnzahlGebaeude'] = EnergiequellenRaster['Elektrizität'] + EnergiequellenRaster['Gas'] + EnergiequellenRaster['Heizöl'] + EnergiequellenRaster['Keine'] + EnergiequellenRaster['Unbestimmt'] + + EnergiequellenRaster['Weitere']
```


```python
EnergiequellenRaster
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RELI</th>
      <th>geometry</th>
      <th>E_KOORD</th>
      <th>N_KOORD</th>
      <th>B21BTOT</th>
      <th>Elektrizität</th>
      <th>Gas</th>
      <th>Heizöl</th>
      <th>Keine</th>
      <th>Unbestimmt</th>
      <th>Weitere</th>
      <th>AnzahlGebaeude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48621113</td>
      <td>POLYGON ((5.96582 46.14355, 5.96711 46.14357, ...</td>
      <td>2486200</td>
      <td>1111300</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48621114</td>
      <td>POLYGON ((5.96580 46.14445, 5.96709 46.14447, ...</td>
      <td>2486200</td>
      <td>1111400</td>
      <td>5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48621115</td>
      <td>POLYGON ((5.96577 46.14535, 5.96707 46.14537, ...</td>
      <td>2486200</td>
      <td>1111500</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48631114</td>
      <td>POLYGON ((5.96709 46.14447, 5.96838 46.14449, ...</td>
      <td>2486300</td>
      <td>1111400</td>
      <td>4</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>48631115</td>
      <td>POLYGON ((5.96707 46.14537, 5.96836 46.14539, ...</td>
      <td>2486300</td>
      <td>1111500</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>346832</th>
      <td>83101690</td>
      <td>POLYGON ((10.45592 46.63227, 10.45722 46.63223...</td>
      <td>2831000</td>
      <td>1169000</td>
      <td>5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>346833</th>
      <td>83101692</td>
      <td>POLYGON ((10.45602 46.63406, 10.45732 46.63403...</td>
      <td>2831000</td>
      <td>1169200</td>
      <td>3</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>346834</th>
      <td>83111692</td>
      <td>POLYGON ((10.45732 46.63403, 10.45863 46.63399...</td>
      <td>2831100</td>
      <td>1169200</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>346835</th>
      <td>83111693</td>
      <td>POLYGON ((10.45737 46.63493, 10.45868 46.63489...</td>
      <td>2831100</td>
      <td>1169300</td>
      <td>13</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>346836</th>
      <td>83202015</td>
      <td>POLYGON ((10.48545 46.92405, 10.48676 46.92402...</td>
      <td>2832000</td>
      <td>1201500</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>346837 rows × 12 columns</p>
</div>




```python
# Die Anzahl Einwohner aus der STATPOP werden nun proportional auf die Gebäude verteilt innerhalb einer Hektarrasterzelle
EnergiequellenRaster['PaxElektrizität'] = EnergiequellenRaster['B21BTOT']/EnergiequellenRaster['AnzahlGebaeude']*EnergiequellenRaster['Elektrizität']
EnergiequellenRaster['PaxGas'] = EnergiequellenRaster['B21BTOT']/EnergiequellenRaster['AnzahlGebaeude']*EnergiequellenRaster['Gas']
EnergiequellenRaster['PaxÖl'] = EnergiequellenRaster['B21BTOT']/EnergiequellenRaster['AnzahlGebaeude']*EnergiequellenRaster['Heizöl']
EnergiequellenRaster['PaxKeine'] = EnergiequellenRaster['B21BTOT']/EnergiequellenRaster['AnzahlGebaeude']*EnergiequellenRaster['Keine']
EnergiequellenRaster['PaxUnbestimmt'] = EnergiequellenRaster['B21BTOT']/EnergiequellenRaster['AnzahlGebaeude']*EnergiequellenRaster['Unbestimmt']
EnergiequellenRaster['PaxWeitere'] = EnergiequellenRaster['B21BTOT']/EnergiequellenRaster['AnzahlGebaeude']*EnergiequellenRaster['Weitere']

```


```python
# Die NULL Werte werden mit 0 ersetzt. Muss noch einmal gemacht werden weil bei einigen wenigen Rasterzellen die AnzahlGebaeude = 0 ist was in einer Dividierung durch 0 entspricht
EnergiequellenRaster = EnergiequellenRaster.fillna(0)
EnergiequellenRaster
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RELI</th>
      <th>geometry</th>
      <th>E_KOORD</th>
      <th>N_KOORD</th>
      <th>B21BTOT</th>
      <th>Elektrizität</th>
      <th>Gas</th>
      <th>Heizöl</th>
      <th>Keine</th>
      <th>Unbestimmt</th>
      <th>Weitere</th>
      <th>AnzahlGebaeude</th>
      <th>PaxElektrizität</th>
      <th>PaxGas</th>
      <th>PaxÖl</th>
      <th>PaxKeine</th>
      <th>PaxUnbestimmt</th>
      <th>PaxWeitere</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48621113</td>
      <td>POLYGON ((5.96582 46.14355, 5.96711 46.14357, ...</td>
      <td>2486200</td>
      <td>1111300</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48621114</td>
      <td>POLYGON ((5.96580 46.14445, 5.96709 46.14447, ...</td>
      <td>2486200</td>
      <td>1111400</td>
      <td>5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>48621115</td>
      <td>POLYGON ((5.96577 46.14535, 5.96707 46.14537, ...</td>
      <td>2486200</td>
      <td>1111500</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48631114</td>
      <td>POLYGON ((5.96709 46.14447, 5.96838 46.14449, ...</td>
      <td>2486300</td>
      <td>1111400</td>
      <td>4</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>48631115</td>
      <td>POLYGON ((5.96707 46.14537, 5.96836 46.14539, ...</td>
      <td>2486300</td>
      <td>1111500</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>346832</th>
      <td>83101690</td>
      <td>POLYGON ((10.45592 46.63227, 10.45722 46.63223...</td>
      <td>2831000</td>
      <td>1169000</td>
      <td>5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>346833</th>
      <td>83101692</td>
      <td>POLYGON ((10.45602 46.63406, 10.45732 46.63403...</td>
      <td>2831000</td>
      <td>1169200</td>
      <td>3</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.5</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <th>346834</th>
      <td>83111692</td>
      <td>POLYGON ((10.45732 46.63403, 10.45863 46.63399...</td>
      <td>2831100</td>
      <td>1169200</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>346835</th>
      <td>83111693</td>
      <td>POLYGON ((10.45737 46.63493, 10.45868 46.63489...</td>
      <td>2831100</td>
      <td>1169300</td>
      <td>13</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.833333</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.166667</td>
    </tr>
    <tr>
      <th>346836</th>
      <td>83202015</td>
      <td>POLYGON ((10.48545 46.92405, 10.48676 46.92402...</td>
      <td>2832000</td>
      <td>1201500</td>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>346837 rows × 18 columns</p>
</div>




```python
# Dataframe entschlacken d.h. Die nicht verwendeten Attribute löschen
PaxPerEnergieRaster = EnergiequellenRaster.drop(['E_KOORD','N_KOORD','B21BTOT','Elektrizität','Gas','Heizöl','Keine','Weitere','AnzahlGebaeude','RELI','Unbestimmt'], axis=1)
```

# 3. Hektarraster einer Gemeinde zuweisen


```python
# Fehlermeldung kann ignoriert werden weil es sich bei den Polygonen um einfache Quadrate handelt.
# Für jede Rasterzelle wird der Mittelpunkt ermittelt.
PaxPerEnergieRaster['geometry'] = PaxPerEnergieRaster.centroid
```

    /tmp/ipykernel_32105/1839232027.py:3: UserWarning: Geometry is in a geographic CRS. Results from 'centroid' are likely incorrect. Use 'GeoSeries.to_crs()' to re-project geometries to a projected CRS before this operation.
    
      PaxPerEnergieRaster['geometry'] = PaxPerEnergieRaster.centroid
    


```python
PaxPerEnergieRaster
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>geometry</th>
      <th>PaxElektrizität</th>
      <th>PaxGas</th>
      <th>PaxÖl</th>
      <th>PaxKeine</th>
      <th>PaxUnbestimmt</th>
      <th>PaxWeitere</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>POINT (5.96645 46.14401)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>POINT (5.96643 46.14491)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>POINT (5.96641 46.14581)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>POINT (5.96772 46.14493)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>POINT (5.96770 46.14583)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>346832</th>
      <td>POINT (10.45659 46.63270)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>346833</th>
      <td>POINT (10.45670 46.63450)</td>
      <td>1.5</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.500000</td>
    </tr>
    <tr>
      <th>346834</th>
      <td>POINT (10.45800 46.63446)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>346835</th>
      <td>POINT (10.45805 46.63536)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.833333</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.166667</td>
    </tr>
    <tr>
      <th>346836</th>
      <td>POINT (10.48613 46.92448)</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>346837 rows × 7 columns</p>
</div>




```python
PaxPerEnergieRaster.isnull().sum()
```




    geometry           0
    PaxElektrizität    0
    PaxGas             0
    PaxÖl              0
    PaxKeine           0
    PaxUnbestimmt      0
    PaxWeitere         0
    dtype: int64




```python
# Die aktuellsten Gemeindegrenzen über die STAC API herunterladen

# Anfragen welche Files verfügbar sind.
StacApiUrl = requests.get('https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d/items')
StacApiAntwortJson = json.loads(StacApiUrl.text)
StacApiAntwort = StacApiAntwortJson['features']
StacApiAntwort
```




    [{'id': 'swissboundaries3d_2021-01',
      'collection': 'ch.swisstopo.swissboundaries3d',
      'type': 'Feature',
      'stac_version': '0.9.0',
      'geometry': {'type': 'Polygon',
       'coordinates': [[[5.3385875, 45.3594856],
         [5.2229406, 48.2425816],
         [11.2575962, 48.2013771],
         [11.0586366, 45.3204053],
         [5.3385875, 45.3594856]]]},
      'bbox': [5.2229406, 45.3204053, 11.2575962, 48.2425816],
      'properties': {'datetime': '2021-01-01T00:00:00Z',
       'created': '2021-07-12T14:09:43.800221Z',
       'updated': '2021-07-12T14:20:45.851774Z'},
      'links': [{'rel': 'self',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d/items/swissboundaries3d_2021-01'},
       {'rel': 'root', 'href': 'https://data.geo.admin.ch/api/stac/v0.9/'},
       {'rel': 'parent',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d'},
       {'rel': 'collection',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d'},
       {'rel': 'alternate',
        'title': 'STAC Browser',
        'type': 'text/html',
        'href': 'https://data.geo.admin.ch/browser/index.html#/collections/ch.swisstopo.swissboundaries3d/items/swissboundaries3d_2021-01'}],
      'assets': {'swissboundaries3d_2021-01_2056_5728.gdb.zip': {'type': 'application/x.filegdb+zip',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2021-01/swissboundaries3d_2021-01_2056_5728.gdb.zip',
        'created': '2021-07-12T14:20:32.174982Z',
        'updated': '2021-07-12T14:20:45.853076Z',
        'proj:epsg': 2056,
        'checksum:multihash': '12202431FD97F0FE9DA829A23766EB75699B64419315B22E59957FCA9523871A394B'},
       'swissboundaries3d_2021-01_2056_5728.shp.zip': {'type': 'application/x.shapefile+zip',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2021-01/swissboundaries3d_2021-01_2056_5728.shp.zip',
        'created': '2021-07-12T14:09:43.938199Z',
        'updated': '2021-07-12T14:09:54.616069Z',
        'proj:epsg': 2056,
        'checksum:multihash': '122057754B335F8B7C509914D6C3CA80B15744D9A5A6B76EA40DDDE22FB9E616065D'},
       'swissboundaries3d_2021-01_2056_5728.xtf.zip': {'type': 'application/x.interlis+zip; version=2.3',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2021-01/swissboundaries3d_2021-01_2056_5728.xtf.zip',
        'created': '2021-07-12T14:18:17.959387Z',
        'updated': '2021-07-12T14:18:30.513942Z',
        'proj:epsg': 2056,
        'checksum:multihash': '1220CF361B42218CDC6165CEE1C3C990E96AE1ADE2E97B9566935CE5A3B448D3DD04'}}},
     {'id': 'swissboundaries3d_2021-04',
      'collection': 'ch.swisstopo.swissboundaries3d',
      'type': 'Feature',
      'stac_version': '0.9.0',
      'geometry': {'type': 'Polygon',
       'coordinates': [[[5.3385875, 45.3594856],
         [5.2229406, 48.2425816],
         [11.2575962, 48.2013771],
         [11.0586366, 45.3204053],
         [5.3385875, 45.3594856]]]},
      'bbox': [5.2229406, 45.3204053, 11.2575962, 48.2425816],
      'properties': {'datetime': '2021-04-18T00:00:00Z',
       'created': '2021-07-12T14:09:55.355150Z',
       'updated': '2021-07-12T14:20:54.412602Z'},
      'links': [{'rel': 'self',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d/items/swissboundaries3d_2021-04'},
       {'rel': 'root', 'href': 'https://data.geo.admin.ch/api/stac/v0.9/'},
       {'rel': 'parent',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d'},
       {'rel': 'collection',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d'},
       {'rel': 'alternate',
        'title': 'STAC Browser',
        'type': 'text/html',
        'href': 'https://data.geo.admin.ch/browser/index.html#/collections/ch.swisstopo.swissboundaries3d/items/swissboundaries3d_2021-04'}],
      'assets': {'swissboundaries3d_2021-04_2056_5728.gdb.zip': {'type': 'application/x.filegdb+zip',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2021-04/swissboundaries3d_2021-04_2056_5728.gdb.zip',
        'created': '2021-07-12T14:20:46.755193Z',
        'updated': '2021-07-12T14:20:54.413932Z',
        'proj:epsg': 2056,
        'checksum:multihash': '12205E38878ABD517D8AD9E550DB20606E82E6EF1E9552EB09AC1E702586CBD818D9'},
       'swissboundaries3d_2021-04_2056_5728.shp.zip': {'type': 'application/x.shapefile+zip',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2021-04/swissboundaries3d_2021-04_2056_5728.shp.zip',
        'created': '2021-07-12T14:09:55.461487Z',
        'updated': '2021-07-12T14:10:03.528478Z',
        'proj:epsg': 2056,
        'checksum:multihash': '1220D21E8E55039E0DB05D5BCBB3ECC48FAFDBF4055A27236B78D7B49601A9D19BC3'},
       'swissboundaries3d_2021-04_2056_5728.xtf.zip': {'type': 'application/x.interlis+zip; version=2.3',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2021-04/swissboundaries3d_2021-04_2056_5728.xtf.zip',
        'created': '2021-07-12T14:18:31.619154Z',
        'updated': '2021-07-12T14:18:38.942877Z',
        'proj:epsg': 2056,
        'checksum:multihash': '1220495EC5C1B474B86334117B12EFA2FAD891373A3E26D0585DB301D49DDAB253CD'}}},
     {'id': 'swissboundaries3d_2021-07',
      'collection': 'ch.swisstopo.swissboundaries3d',
      'type': 'Feature',
      'stac_version': '0.9.0',
      'geometry': {'type': 'Polygon',
       'coordinates': [[[5.3385875, 45.3594856],
         [5.2229406, 48.2425816],
         [11.2575962, 48.2013771],
         [11.0586366, 45.3204053],
         [5.3385875, 45.3594856]]]},
      'bbox': [5.2229406, 45.3204053, 11.2575962, 48.2425816],
      'properties': {'datetime': '2021-07-01T00:00:00Z',
       'created': '2021-07-12T14:10:04.251374Z',
       'updated': '2021-07-12T14:21:03.578971Z'},
      'links': [{'rel': 'self',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d/items/swissboundaries3d_2021-07'},
       {'rel': 'root', 'href': 'https://data.geo.admin.ch/api/stac/v0.9/'},
       {'rel': 'parent',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d'},
       {'rel': 'collection',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d'},
       {'rel': 'alternate',
        'title': 'STAC Browser',
        'type': 'text/html',
        'href': 'https://data.geo.admin.ch/browser/index.html#/collections/ch.swisstopo.swissboundaries3d/items/swissboundaries3d_2021-07'}],
      'assets': {'swissboundaries3d_2021-07_2056_5728.gdb.zip': {'type': 'application/x.filegdb+zip',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2021-07/swissboundaries3d_2021-07_2056_5728.gdb.zip',
        'created': '2021-07-12T14:20:55.099027Z',
        'updated': '2021-07-12T14:21:03.580257Z',
        'proj:epsg': 2056,
        'checksum:multihash': '122028704206F81CDCD897EF3892087DD7E08CB750E152364C04187CC56C6C3E9156'},
       'swissboundaries3d_2021-07_2056_5728.shp.zip': {'type': 'application/x.shapefile+zip',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2021-07/swissboundaries3d_2021-07_2056_5728.shp.zip',
        'created': '2021-07-12T14:10:04.397393Z',
        'updated': '2021-07-12T14:10:11.156910Z',
        'proj:epsg': 2056,
        'checksum:multihash': '1220189BF575A97F641841BA1B9C363C4880D5CD6C681C4D0FDD64DD5B802AB15CA4'},
       'swissboundaries3d_2021-07_2056_5728.xtf.zip': {'type': 'application/x.interlis+zip; version=2.3',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2021-07/swissboundaries3d_2021-07_2056_5728.xtf.zip',
        'created': '2021-07-12T14:18:39.944551Z',
        'updated': '2021-07-12T14:18:57.764356Z',
        'proj:epsg': 2056,
        'checksum:multihash': '1220E12598A4B34A11370AB2A441653285D4FC74025EF903BA323D6105172390FD12'}}},
     {'id': 'swissboundaries3d_2022-01',
      'collection': 'ch.swisstopo.swissboundaries3d',
      'type': 'Feature',
      'stac_version': '0.9.0',
      'geometry': {'type': 'Polygon',
       'coordinates': [[[5.3385875, 45.3594856],
         [5.2229406, 48.2425816],
         [11.2575962, 48.2013771],
         [11.0586366, 45.3204053],
         [5.3385875, 45.3594856]]]},
      'bbox': [5.2229406, 45.3204053, 11.2575962, 48.2425816],
      'properties': {'datetime': '2022-01-01T00:00:00Z',
       'created': '2022-01-03T08:17:34.650879Z',
       'updated': '2022-01-03T08:17:58.258784Z'},
      'links': [{'rel': 'self',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d/items/swissboundaries3d_2022-01'},
       {'rel': 'root', 'href': 'https://data.geo.admin.ch/api/stac/v0.9/'},
       {'rel': 'parent',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d'},
       {'rel': 'collection',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d'},
       {'rel': 'alternate',
        'title': 'STAC Browser',
        'type': 'text/html',
        'href': 'https://data.geo.admin.ch/browser/index.html#/collections/ch.swisstopo.swissboundaries3d/items/swissboundaries3d_2022-01'}],
      'assets': {'swissboundaries3d_2022-01_2056_5728.gdb.zip': {'type': 'application/x.filegdb+zip',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2022-01/swissboundaries3d_2022-01_2056_5728.gdb.zip',
        'created': '2022-01-03T08:17:56.179930Z',
        'updated': '2022-01-03T08:17:58.258784Z',
        'proj:epsg': 2056,
        'checksum:multihash': '1220A02DBBB61987BABA81BD7C78D6A2B33C93AF5EE5A529DD64B0B1683853C65F13'},
       'swissboundaries3d_2022-01_2056_5728.shp.zip': {'type': 'application/x.shapefile+zip',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2022-01/swissboundaries3d_2022-01_2056_5728.shp.zip',
        'created': '2022-01-03T08:17:40.468901Z',
        'updated': '2022-01-03T08:17:42.975330Z',
        'proj:epsg': 2056,
        'checksum:multihash': '1220BFA64FD9368170247B63C96C01AB6AB15BE57D0380A74C0A63C76831330977C2'},
       'swissboundaries3d_2022-01_2056_5728.xtf.zip': {'type': 'application/x.interlis+zip; version=2.3',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2022-01/swissboundaries3d_2022-01_2056_5728.xtf.zip',
        'created': '2022-01-03T08:17:34.776842Z',
        'updated': '2022-01-03T08:17:37.711821Z',
        'proj:epsg': 2056,
        'checksum:multihash': '1220DA36176ED0453CC392CFA7AC22CDAEDE2D06106C5965E81D542A4C433F5F0391'}}},
     {'id': 'swissboundaries3d_2022-05',
      'collection': 'ch.swisstopo.swissboundaries3d',
      'type': 'Feature',
      'stac_version': '0.9.0',
      'geometry': {'type': 'Polygon',
       'coordinates': [[[5.3385875, 45.3594856],
         [5.2229406, 48.2425816],
         [11.2575962, 48.2013771],
         [11.0586366, 45.3204053],
         [5.3385875, 45.3594856]]]},
      'bbox': [5.2229406, 45.3204053, 11.2575962, 48.2425816],
      'properties': {'datetime': '2022-05-01T00:00:00Z',
       'created': '2022-05-02T07:11:13.630880Z',
       'updated': '2022-05-02T07:17:28.475892Z'},
      'links': [{'rel': 'self',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d/items/swissboundaries3d_2022-05'},
       {'rel': 'root', 'href': 'https://data.geo.admin.ch/api/stac/v0.9/'},
       {'rel': 'parent',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d'},
       {'rel': 'collection',
        'href': 'https://data.geo.admin.ch/api/stac/v0.9/collections/ch.swisstopo.swissboundaries3d'},
       {'rel': 'alternate',
        'title': 'STAC Browser',
        'type': 'text/html',
        'href': 'https://data.geo.admin.ch/browser/index.html#/collections/ch.swisstopo.swissboundaries3d/items/swissboundaries3d_2022-05'}],
      'assets': {'swissboundaries3d_2022-05_2056_5728.gdb.zip': {'type': 'application/x.filegdb+zip',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2022-05/swissboundaries3d_2022-05_2056_5728.gdb.zip',
        'created': '2022-05-02T07:14:13.684469Z',
        'updated': '2022-05-02T07:14:21.505349Z',
        'proj:epsg': 2056,
        'checksum:multihash': '122082FA7C5AF9892020E1A90BC9092C10EA9228181139D611E3367A9B918A583C45'},
       'swissboundaries3d_2022-05_2056_5728.shp.zip': {'type': 'application/x.shapefile+zip',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2022-05/swissboundaries3d_2022-05_2056_5728.shp.zip',
        'created': '2022-05-02T07:11:13.773358Z',
        'updated': '2022-05-02T07:11:26.868817Z',
        'proj:epsg': 2056,
        'checksum:multihash': '122097E09EFD4F120B2F29F1BB548F5C581F3AA0329CBC7C74DF56B80C05EBB30420'},
       'swissboundaries3d_2022-05_2056_5728.xtf.zip': {'type': 'application/x.interlis+zip; version=2.3',
        'href': 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/swissboundaries3d_2022-05/swissboundaries3d_2022-05_2056_5728.xtf.zip',
        'created': '2022-05-02T07:17:13.778156Z',
        'updated': '2022-05-02T07:17:28.475892Z',
        'proj:epsg': 2056,
        'checksum:multihash': '1220DE04DBA0C3A0F6E1D7C6D525B4EA4251A806F38B896DC6991336D3CD229B74BC'}}}]




```python
# Die Antwort in ein Dataframe schreiben und das Datum als Zeitstempel speichern.
StacJsonAntwort = pd.json_normalize(StacApiAntwort)
StacJsonAntwort = StacJsonAntwort[['id','properties.datetime']]
StacJsonAntwort['properties.datetime'] = pd.to_datetime(StacJsonAntwort['properties.datetime'])
StacJsonAntwort
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>properties.datetime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>swissboundaries3d_2021-01</td>
      <td>2021-01-01 00:00:00+00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>swissboundaries3d_2021-04</td>
      <td>2021-04-18 00:00:00+00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>swissboundaries3d_2021-07</td>
      <td>2021-07-01 00:00:00+00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>swissboundaries3d_2022-01</td>
      <td>2022-01-01 00:00:00+00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>swissboundaries3d_2022-05</td>
      <td>2022-05-01 00:00:00+00:00</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Zeitstempel des aktuellsten Files rausfiltern
Zeitstempel = StacJsonAntwort.max().id
Zeitstempel
```




    'swissboundaries3d_2022-05'




```python
# Aktuellstes File herunterladen und entzippen
datenurl = 'https://data.geo.admin.ch/ch.swisstopo.swissboundaries3d/' + Zeitstempel + '/' + Zeitstempel + '_2056_5728.gdb.zip'
r = requests.get(datenurl)
open('Gemeinde/Gemeindegrenzen.zip','wb').write(r.content)

with ZipFile('Gemeinde/Gemeindegrenzen.zip', 'r') as zip_ref:
    zip_ref.extractall('Gemeinde')
```


```python
#Gemeindegrenzen reinladen
switzerland_gemeinde = gpd.read_file('Gemeinde/swissBOUNDARIES3D_1_3_LV95_LN02.gdb', layer=3).to_crs(epsg='4326')
switzerland_gemeinde
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>UUID</th>
      <th>DATUM_AENDERUNG</th>
      <th>DATUM_ERSTELLUNG</th>
      <th>ERSTELLUNG_JAHR</th>
      <th>ERSTELLUNG_MONAT</th>
      <th>REVISION_JAHR</th>
      <th>REVISION_MONAT</th>
      <th>GRUND_AENDERUNG</th>
      <th>HERKUNFT</th>
      <th>HERKUNFT_JAHR</th>
      <th>...</th>
      <th>GEM_TEIL</th>
      <th>GEM_FLAECHE</th>
      <th>SEE_FLAECHE</th>
      <th>ICC</th>
      <th>SHN</th>
      <th>REVISION_QUALITAET</th>
      <th>EINWOHNERZAHL</th>
      <th>Shape_Length</th>
      <th>Shape_Area</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>{D5A9677C-FE38-44F6-B0E8-3177F6252C81}</td>
      <td>2020-11-03 09:12:28+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>2000</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2020</td>
      <td>...</td>
      <td>0</td>
      <td>43861.0</td>
      <td>NaN</td>
      <td>CH</td>
      <td>CH18433762</td>
      <td>2021_Aufbau</td>
      <td>4624.0</td>
      <td>112473.317556</td>
      <td>4.386061e+08</td>
      <td>MULTIPOLYGON Z (((10.23251 46.87160 2980.12200...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>{B55F9EAE-EB69-4468-A41C-7BB28A6699EE}</td>
      <td>2021-10-26 13:07:34+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>2006</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2021</td>
      <td>...</td>
      <td>0</td>
      <td>43003.0</td>
      <td>NaN</td>
      <td>CH</td>
      <td>CH08001631</td>
      <td>2021_Aufbau</td>
      <td>9480.0</td>
      <td>116787.901278</td>
      <td>4.300324e+08</td>
      <td>MULTIPOLYGON Z (((8.95776 46.80444 3402.83600,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>{AB2BA4A5-EB8C-40C7-A259-271DAC93C767}</td>
      <td>2021-10-26 13:07:12+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>2000</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2021</td>
      <td>...</td>
      <td>0</td>
      <td>34404.0</td>
      <td>NaN</td>
      <td>CH</td>
      <td>CH18433746</td>
      <td>2021_Aufbau</td>
      <td>1506.0</td>
      <td>102012.979193</td>
      <td>3.440368e+08</td>
      <td>MULTIPOLYGON Z (((10.10516 46.84090 3111.08100...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>{550D0610-1EE3-4748-8F29-88072753FFDC}</td>
      <td>2021-10-26 13:07:19+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>2000</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2021</td>
      <td>...</td>
      <td>0</td>
      <td>32377.0</td>
      <td>NaN</td>
      <td>CH</td>
      <td>CH18413543</td>
      <td>2021_Aufbau</td>
      <td>2377.0</td>
      <td>93629.567857</td>
      <td>3.237737e+08</td>
      <td>MULTIPOLYGON Z (((9.49892 46.62472 2730.10000,...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>{5B0C1705-1D2B-4E53-9970-6BC3DE33A0F7}</td>
      <td>2021-10-26 13:07:08+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>1997</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2021</td>
      <td>...</td>
      <td>0</td>
      <td>30191.0</td>
      <td>NaN</td>
      <td>CH</td>
      <td>CH23036037</td>
      <td>2021_Aufbau</td>
      <td>10329.0</td>
      <td>106069.364264</td>
      <td>3.019118e+08</td>
      <td>MULTIPOLYGON Z (((7.29444 45.92182 3576.25800,...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2281</th>
      <td>{7FAC8A17-64F7-4920-B7EC-29A4B4F3630E}</td>
      <td>2015-12-08 15:34:34+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>1997</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2015</td>
      <td>...</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CH</td>
      <td>CH19094257</td>
      <td>2021_Aufbau</td>
      <td>NaN</td>
      <td>392.427744</td>
      <td>6.167572e+03</td>
      <td>MULTIPOLYGON Z (((7.79979 47.49804 482.51200, ...</td>
    </tr>
    <tr>
      <th>2282</th>
      <td>{454AF364-1D3A-4EC8-9033-B5FF8320DBB0}</td>
      <td>2015-12-10 09:35:38+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>2002</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2015</td>
      <td>...</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CH</td>
      <td>CH16003104</td>
      <td>2021_Aufbau</td>
      <td>NaN</td>
      <td>303.496096</td>
      <td>5.820701e+03</td>
      <td>MULTIPOLYGON Z (((9.36218 47.38678 783.96600, ...</td>
    </tr>
    <tr>
      <th>2283</th>
      <td>{CF0F9771-1C72-4F3D-9476-8D928A01C031}</td>
      <td>2015-12-10 09:35:33+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>2002</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2015</td>
      <td>...</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CH</td>
      <td>CH16003111</td>
      <td>2021_Aufbau</td>
      <td>NaN</td>
      <td>246.833477</td>
      <td>2.789099e+03</td>
      <td>MULTIPOLYGON Z (((9.61262 47.44358 643.66300, ...</td>
    </tr>
    <tr>
      <th>2284</th>
      <td>{B9D2A8BB-2A0B-4F54-9200-F9947892E6F1}</td>
      <td>2021-10-26 13:07:30+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>2000</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2021</td>
      <td>...</td>
      <td>0</td>
      <td>1830.0</td>
      <td>237.0</td>
      <td>CH</td>
      <td>CH25006621</td>
      <td>2021_Aufbau</td>
      <td>203856.0</td>
      <td>22802.041363</td>
      <td>1.829613e+07</td>
      <td>MULTIPOLYGON Z (((6.12765 46.18777 379.24200, ...</td>
    </tr>
    <tr>
      <th>2285</th>
      <td>{D7E8A67B-13C5-46F6-B572-060AD44C3F27}</td>
      <td>2021-10-26 13:07:19+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>1997</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2021</td>
      <td>...</td>
      <td>0</td>
      <td>270.0</td>
      <td>NaN</td>
      <td>CH</td>
      <td>CH25006608</td>
      <td>2021_Aufbau</td>
      <td>22536.0</td>
      <td>8991.988013</td>
      <td>2.696751e+06</td>
      <td>MULTIPOLYGON Z (((6.12765 46.18777 379.24200, ...</td>
    </tr>
  </tbody>
</table>
<p>2286 rows × 26 columns</p>
</div>




```python
switzerland_gemeinde['NAME']
```




    0                Scuol
    1           Glarus Süd
    2               Zernez
    3               Surses
    4        Val de Bagnes
                 ...      
    2281           Olsberg
    2282    Schlatt-Haslen
    2283           Oberegg
    2284            Genève
    2285      Carouge (GE)
    Name: NAME, Length: 2286, dtype: object




```python
switzerland_gemeinde.plot(markersize=.1, figsize=(8, 8))

```




    <AxesSubplot: >




    
![png](https://raw.githubusercontent.com/nrohrbach/HeizcheckGemeinde/pages/Bilder/output_41_1.png)
    



```python
#Spatial Join der Wohnbevölkerung im Hektarraster (StatpopRaster) und der Wohngebäude aus dem GWR (Wohngebaeude_gdf)
gemeindejoin = gpd.sjoin(switzerland_gemeinde, PaxPerEnergieRaster)
gemeindejoin
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>UUID</th>
      <th>DATUM_AENDERUNG</th>
      <th>DATUM_ERSTELLUNG</th>
      <th>ERSTELLUNG_JAHR</th>
      <th>ERSTELLUNG_MONAT</th>
      <th>REVISION_JAHR</th>
      <th>REVISION_MONAT</th>
      <th>GRUND_AENDERUNG</th>
      <th>HERKUNFT</th>
      <th>HERKUNFT_JAHR</th>
      <th>...</th>
      <th>Shape_Length</th>
      <th>Shape_Area</th>
      <th>geometry</th>
      <th>index_right</th>
      <th>PaxElektrizität</th>
      <th>PaxGas</th>
      <th>PaxÖl</th>
      <th>PaxKeine</th>
      <th>PaxUnbestimmt</th>
      <th>PaxWeitere</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>{D5A9677C-FE38-44F6-B0E8-3177F6252C81}</td>
      <td>2020-11-03 09:12:28+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>2000</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2020</td>
      <td>...</td>
      <td>112473.317556</td>
      <td>4.386061e+08</td>
      <td>MULTIPOLYGON Z (((10.23251 46.87160 2980.12200...</td>
      <td>346440</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>6.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>{D5A9677C-FE38-44F6-B0E8-3177F6252C81}</td>
      <td>2020-11-03 09:12:28+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>2000</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2020</td>
      <td>...</td>
      <td>112473.317556</td>
      <td>4.386061e+08</td>
      <td>MULTIPOLYGON Z (((10.23251 46.87160 2980.12200...</td>
      <td>346557</td>
      <td>5.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>{D5A9677C-FE38-44F6-B0E8-3177F6252C81}</td>
      <td>2020-11-03 09:12:28+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>2000</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2020</td>
      <td>...</td>
      <td>112473.317556</td>
      <td>4.386061e+08</td>
      <td>MULTIPOLYGON Z (((10.23251 46.87160 2980.12200...</td>
      <td>346434</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>2.333333</td>
      <td>0.0</td>
      <td>11.666667</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>{D5A9677C-FE38-44F6-B0E8-3177F6252C81}</td>
      <td>2020-11-03 09:12:28+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>2000</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2020</td>
      <td>...</td>
      <td>112473.317556</td>
      <td>4.386061e+08</td>
      <td>MULTIPOLYGON Z (((10.23251 46.87160 2980.12200...</td>
      <td>346431</td>
      <td>1.0</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>2.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>{D5A9677C-FE38-44F6-B0E8-3177F6252C81}</td>
      <td>2020-11-03 09:12:28+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>2000</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2020</td>
      <td>...</td>
      <td>112473.317556</td>
      <td>4.386061e+08</td>
      <td>MULTIPOLYGON Z (((10.23251 46.87160 2980.12200...</td>
      <td>346496</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>6.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2285</th>
      <td>{D7E8A67B-13C5-46F6-B572-060AD44C3F27}</td>
      <td>2021-10-26 13:07:19+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>1997</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2021</td>
      <td>...</td>
      <td>8991.988013</td>
      <td>2.696751e+06</td>
      <td>MULTIPOLYGON Z (((6.12765 46.18777 379.24200, ...</td>
      <td>3493</td>
      <td>0.0</td>
      <td>53.250000</td>
      <td>17.750000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2285</th>
      <td>{D7E8A67B-13C5-46F6-B572-060AD44C3F27}</td>
      <td>2021-10-26 13:07:19+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>1997</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2021</td>
      <td>...</td>
      <td>8991.988013</td>
      <td>2.696751e+06</td>
      <td>MULTIPOLYGON Z (((6.12765 46.18777 379.24200, ...</td>
      <td>3578</td>
      <td>0.0</td>
      <td>37.583333</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>3.416667</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2285</th>
      <td>{D7E8A67B-13C5-46F6-B572-060AD44C3F27}</td>
      <td>2021-10-26 13:07:19+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>1997</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2021</td>
      <td>...</td>
      <td>8991.988013</td>
      <td>2.696751e+06</td>
      <td>MULTIPOLYGON Z (((6.12765 46.18777 379.24200, ...</td>
      <td>3492</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2285</th>
      <td>{D7E8A67B-13C5-46F6-B572-060AD44C3F27}</td>
      <td>2021-10-26 13:07:19+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>1997</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2021</td>
      <td>...</td>
      <td>8991.988013</td>
      <td>2.696751e+06</td>
      <td>MULTIPOLYGON Z (((6.12765 46.18777 379.24200, ...</td>
      <td>3577</td>
      <td>0.0</td>
      <td>27.428571</td>
      <td>4.571429</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2285</th>
      <td>{D7E8A67B-13C5-46F6-B572-060AD44C3F27}</td>
      <td>2021-10-26 13:07:19+00:00</td>
      <td>2008-11-24 00:00:00+00:00</td>
      <td>1997</td>
      <td>1</td>
      <td>2022</td>
      <td>5</td>
      <td>400</td>
      <td>500</td>
      <td>2021</td>
      <td>...</td>
      <td>8991.988013</td>
      <td>2.696751e+06</td>
      <td>MULTIPOLYGON Z (((6.12765 46.18777 379.24200, ...</td>
      <td>3576</td>
      <td>0.0</td>
      <td>1.500000</td>
      <td>1.500000</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>346751 rows × 33 columns</p>
</div>




```python
# Zählt alle Gebäude pro Gemeinde, Bauperiode und Energiequelle
Gemeindeliste = gemeindejoin[['PaxGas','PaxÖl','PaxElektrizität','PaxKeine','PaxUnbestimmt','PaxWeitere']].sum().reset_index()
Gemeindeliste
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>PaxGas</td>
      <td>2.018858e+06</td>
    </tr>
    <tr>
      <th>1</th>
      <td>PaxÖl</td>
      <td>3.380076e+06</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PaxElektrizität</td>
      <td>3.870217e+05</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PaxKeine</td>
      <td>1.502859e+05</td>
    </tr>
    <tr>
      <th>4</th>
      <td>PaxUnbestimmt</td>
      <td>1.421563e+06</td>
    </tr>
    <tr>
      <th>5</th>
      <td>PaxWeitere</td>
      <td>1.442623e+06</td>
    </tr>
  </tbody>
</table>
</div>




```python
GemeindeEinwohner = gemeindejoin.groupby(['NAME'])['PaxGas','PaxÖl','PaxKeine','PaxUnbestimmt','PaxWeitere'].agg('sum')
```

    /tmp/ipykernel_32105/4213906229.py:1: FutureWarning: Indexing with multiple keys (implicitly converted to a tuple of keys) will be deprecated, use a list instead.
      GemeindeEinwohner = gemeindejoin.groupby(['NAME'])['PaxGas','PaxÖl','PaxKeine','PaxUnbestimmt','PaxWeitere'].agg('sum')
    


```python
GemeindeEinwohner
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PaxGas</th>
      <th>PaxÖl</th>
      <th>PaxKeine</th>
      <th>PaxUnbestimmt</th>
      <th>PaxWeitere</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Aadorf</th>
      <td>3052.745244</td>
      <td>2994.955013</td>
      <td>21.145022</td>
      <td>1386.272859</td>
      <td>1591.391402</td>
    </tr>
    <tr>
      <th>Aarau</th>
      <td>8276.148334</td>
      <td>8298.592317</td>
      <td>11.721612</td>
      <td>2884.107022</td>
      <td>1595.191515</td>
    </tr>
    <tr>
      <th>Aarberg</th>
      <td>796.592051</td>
      <td>1992.827463</td>
      <td>22.046154</td>
      <td>1276.457763</td>
      <td>308.869334</td>
    </tr>
    <tr>
      <th>Aarburg</th>
      <td>3090.971294</td>
      <td>3018.498624</td>
      <td>16.438462</td>
      <td>1706.718669</td>
      <td>600.823469</td>
    </tr>
    <tr>
      <th>Aarwangen</th>
      <td>94.700396</td>
      <td>2544.096628</td>
      <td>26.671717</td>
      <td>1324.753096</td>
      <td>615.672094</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Zwingen</th>
      <td>30.766667</td>
      <td>1250.563730</td>
      <td>472.163987</td>
      <td>0.000000</td>
      <td>745.780723</td>
    </tr>
    <tr>
      <th>Zwischbergen</th>
      <td>0.000000</td>
      <td>0.933333</td>
      <td>2.333333</td>
      <td>0.000000</td>
      <td>14.666667</td>
    </tr>
    <tr>
      <th>Zäziwil</th>
      <td>0.000000</td>
      <td>735.861469</td>
      <td>31.430769</td>
      <td>322.272552</td>
      <td>448.119841</td>
    </tr>
    <tr>
      <th>Zürich</th>
      <td>188784.415680</td>
      <td>98847.584173</td>
      <td>30438.731332</td>
      <td>9403.669919</td>
      <td>95700.081812</td>
    </tr>
    <tr>
      <th>Zürichsee (ZH)</th>
      <td>141.700000</td>
      <td>150.275000</td>
      <td>3.500000</td>
      <td>82.275000</td>
      <td>17.250000</td>
    </tr>
  </tbody>
</table>
<p>2153 rows × 5 columns</p>
</div>




```python
# Werte auf Ganzzahlen runden
GemeindeEinwohner = round(GemeindeEinwohner).reset_index()
GemeindeEinwohner
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NAME</th>
      <th>PaxGas</th>
      <th>PaxÖl</th>
      <th>PaxKeine</th>
      <th>PaxUnbestimmt</th>
      <th>PaxWeitere</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aadorf</td>
      <td>3053.0</td>
      <td>2995.0</td>
      <td>21.0</td>
      <td>1386.0</td>
      <td>1591.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Aarau</td>
      <td>8276.0</td>
      <td>8299.0</td>
      <td>12.0</td>
      <td>2884.0</td>
      <td>1595.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Aarberg</td>
      <td>797.0</td>
      <td>1993.0</td>
      <td>22.0</td>
      <td>1276.0</td>
      <td>309.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Aarburg</td>
      <td>3091.0</td>
      <td>3018.0</td>
      <td>16.0</td>
      <td>1707.0</td>
      <td>601.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Aarwangen</td>
      <td>95.0</td>
      <td>2544.0</td>
      <td>27.0</td>
      <td>1325.0</td>
      <td>616.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2148</th>
      <td>Zwingen</td>
      <td>31.0</td>
      <td>1251.0</td>
      <td>472.0</td>
      <td>0.0</td>
      <td>746.0</td>
    </tr>
    <tr>
      <th>2149</th>
      <td>Zwischbergen</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2150</th>
      <td>Zäziwil</td>
      <td>0.0</td>
      <td>736.0</td>
      <td>31.0</td>
      <td>322.0</td>
      <td>448.0</td>
    </tr>
    <tr>
      <th>2151</th>
      <td>Zürich</td>
      <td>188784.0</td>
      <td>98848.0</td>
      <td>30439.0</td>
      <td>9404.0</td>
      <td>95700.0</td>
    </tr>
    <tr>
      <th>2152</th>
      <td>Zürichsee (ZH)</td>
      <td>142.0</td>
      <td>150.0</td>
      <td>4.0</td>
      <td>82.0</td>
      <td>17.0</td>
    </tr>
  </tbody>
</table>
<p>2153 rows × 6 columns</p>
</div>




```python
# Die Spaltennamen des DataFrames neu benennen
GemeindeEinwohner.columns  = ['Gemeinde','PaxGas','PaxÖl','PaxKeine','PaxUnbestimmt','PaxWeitere']
```

## Daten als CSV-Datei exportieren


```python
# Als CSV-File exportieren
GemeindeEinwohner.to_csv('Daten/Gemeindeliste_1-2.csv', index = False, header=True, sep=',', encoding="utf-8-sig")
```


```python

```
